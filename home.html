<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
  <meta https-equiv="X-UA-Compatible" content="ie=edge">
  <meta https-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="icon" href="./icon.jpeg">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="app.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
    integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
    crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
    integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
    crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/92d607ead1.js" crossorigin="anonymous"></script>
  <script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCcH5Qy8dTYdMNvQ8ufSzW9wpHY2qGhFK4&libraries=places"></script>
  <title>DuckHawk - Online Shopping.</title>

  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-messaging.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-functions.js"></script>

  <style>
    .card {
      cursor: pointer;
      height: 100%;
    }

    .card a {
      color: inherit;
      text-decoration: none;
      text-align: center;
      display: flex;
      flex-flow: column;
    }

    .card-body {
      flex-grow: 1;
      text-align: center;
      min-height: 40px;
    }

    @media (max-width: 320px) {
      .card-body h5 {
        font-size: medium;
      }
    }

    .card-title {
      position: absolute;
      bottom: 2px;
      width: 70%;
      text-align: center;
    }

    #map {
      width: 100%;
      height: 300px;
      border-radius: 30px;
    }

    @media (min-width: 998px) {
      #map {
        height: 480px;
      }
    }
  </style>

</head>

<body onload="load()">
  <!-- NAVBAR START -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top" style="z-index: 16;">


    <a class="navbar-brand" href="#" id="sidebarCollapse"><i class="fa fa-location-arrow"></i> <span
        id="cityname">Location</span> </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item active">
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./">DuckHawk</a>
          <!-- <a class="nav-link" href="#" id="sidebarCollapse"><i class="fa fa-location-arrow"></i> <span id="cityname">
                  Location</span> </a> -->
        </li>
      </ul>

      <form class="form-inline my-2 my-lg-0">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" data-toggle="modal" data-target="#login" id="signin"> Sign in </a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="myprof" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              My Profile
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="#" onclick="prof()">My Profile</a>
              <a class="dropdown-item" href="#">My Orders</a>
              <a class="dropdown-item" href="#" onclick="logout()">Log out</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
              aria-haspopup="true" aria-expanded="false">
              More
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="#" onclick="checkSeller()">Sell on DuckHawk</a>
              <a class="dropdown-item" href="#">Contact us</a>
            </div>
          </li>
          <li class="nav-item">
            <div id="cart" class="som">
              <a class="nav-link" href="Cart.html">
                <div id="itemincart" class="cartcount" style="display: none;"></div>
                <i class="fa fa-shopping-cart"></i>
                Cart
              </a>
            </div>
          </li>
        </ul>
        <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
      </form>
    </div>
  </nav>
  <!-- NAVBAR CLOSE -->

  <!-- CODE FOR LOCATION -->


  <nav id="sidebar">

    <div class="container">
      <div class="row">
        <div id="dismiss">
          <i class="fas fa-arrow-left"></i>
        </div>

        <div class="sidebar-header">
          <h5>Set Your Location</h5>
        </div>
      </div>
      <div class="row">
        <div class="col-md" style="margin: 10px 0px;">
          <input class="form-control mr-sm-2" title="location" name="locationin" type="text" value=""
            placeholder="e.g. Delhi" aria-label="Search" id="locationin" autocomplete="off">
          <div class="hide">
            <p id="stext">You can sreach here for area, street name, city, mantions, etc.... <br>Other wise you can give
              your
              current location from picking the location from the Map below.</p>
            <p>On idle position: <span id="onIdlePositionView"></span></p>
            <p>On click position: <span id="onClickPositionView"></span></p>
          </div>
        </div>
        <div class="col-md">

          <div id="map"></div>
          <br>
          <button id="getCurrent">Get Current Position</button>
          <button id="confirmPosition">Confirm Position</button>
        </div>
      </div>
    </div>
  </nav>


  <!--Script for Location -->
  <script src="https://unpkg.com/location-picker/dist/location-picker.min.js"></script>

  <script>
    // Get element references

    var i = 0;
    var confirmBtn = document.getElementById('confirmPosition');
    var onClickPositionView = document.getElementById('onClickPositionView');
    var onIdlePositionView = document.getElementById('onIdlePositionView');
    var map = document.getElementById('map');

    // Initialize LocationPicker plugin
    var lp = new locationPicker(map, {
      setCurrentPosition: true, // You can omit this, defaults to true
    }, {
      gestureHandling: 'greedy',
      streetViewControl: false,
      zoomControl: false,
      zoom: 15 // You can set any google map options here, zoom defaults to 15
    });

    var getCur = document.getElementById('getCurrent');
    getCur.onclick = function () {
      lp.setCurrentPosition();
    }

    function reload() {
      location.reload();
    }

    // Listen to button onclick event
    confirmBtn.onclick = function () {
      // Get current location and show it in HTML
      var location = lp.getMarkerPosition();
      onClickPositionView.innerHTML = 'The chosen location is ' + location.lat + ',' + location.lng;
      localStorage.setItem("Loclat", location.lat);
      localStorage.setItem("Loclng", location.lng);
      document.getElementById('cityname').innerHTML = localStorage.cus_city_tobe;
      localStorage.setItem('cus_city', localStorage.cus_city_tobe);
      // document.getElementById('cityname').innerHTML = (i == 2) ? selectedcity[0] : cityName;
      $('#sidebar').toggleClass('active');
      setTimeout(() => {
        reload();
      }, 30)
    };

    // Listen to map idle event, listening to idle event more accurate than listening to ondrag event
    google.maps.event.addListener(lp.map, 'idle', function (event) {
      // Get current location and show it in HTML
      var location = lp.getMarkerPosition();
      var latitude = location.lat;
      var longitude = location.lng;
      var geocoder;
      geocoder = new google.maps.Geocoder();
      var latlng = new google.maps.LatLng(latitude, longitude, 1);

      document.getElementById('cityname').innerHTML = localStorage.cus_city;

      geocoder.geocode(
        { 'latLng': latlng },
        function (results, status) {
          if (status == google.maps.GeocoderStatus.OK) {
            // console.log(results, status)
            if (results[0]) {
              var add = results[0].formatted_address;
              var value = add.split(",");
              count = value.length;
              country = value[count - 1];
              state = value[count - 2];
              city = value[count - 3];
              console.log(value);
              console.log("city name is: " + city);

              localStorage.setItem('cus_city_tobe', $.trim(city));

              onIdlePositionView.innerHTML = 'The chosen location is ' + location.lat + ',' + location.lng + " " + results[0].formatted_address;

              cityName = results[0].formatted_address;
              console.log(cityName);
              i = i * 2;
              // document.getElementById('cityname').innerHTML = city;

              var m = new google.maps.Map(document.getElementById('m'), {
                center: latlng,
                zoom: 1
              });

              // var service = new google.maps.places.PlacesService(m);
              // service.nearbySearch({
              //   location: latlng,
              //   // rankBy: google.maps.places.RankBy.DISTANCE,
              //   radius: '50',
              //   types: ["establishment"],
              //   types: ['address']
              // }, function(results, status) {
              //   if (status === google.maps.places.PlacesServiceStatus.OK) {
              //     // for (var i = 0; i < results.length; i++) {
              //     // //  console.log(results[i])
              //     // }
              //     cityName = results[0];
              //     console.log(cityName);
              //   } else {
              //     alert('nearbySearch was not successful for the following reason: ' + status);
              //   }
              // });
            }
            else {
              console.log("address not found");
            }
          }
          else {
            console.log("Geocoder failed due to: " + status);
          }
        }
      );
    });


    var selectedcity;
    var lat;
    var lng;

    var ppp;
    var autocomplete = new google.maps.places.Autocomplete(
          /** @type {!HTMLInputElement} */(
        document.getElementById('locationin')), {
      types: ['address'], types: ['establishment'],
    });
    google.maps.event.addListener(autocomplete, 'place_changed', function () {
      var place = autocomplete.getPlace();
      ppp = place;
      console.log("place name is ", place);
      selectedcity = place.name.split(',');
      i = 1;
      // document.getElementById('cityname').innerHTML = selectedcity[0];
      lp.setLocation(place.geometry.location.lat(), place.geometry.location.lng());
    });


    function onReloadLocation() {
      if (localStorage.getItem('Loclat')) {
        lp.setLocation(localStorage.getItem('Loclat'), localStorage.getItem('Loclng'))
        document.getElementById("dismiss").style.display = "block"
      } else {
        alert("Set your Location..!")
        document.getElementById("dismiss").style.display = "none"
      }
    }

  </script>

  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script>

  <script type="text/javascript">

    $(document).ready(function () {

      $('#dismiss, .overlay').on('click', function () {
        $('#sidebar').removeClass('active');
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar').addClass('active');
        // locationauto();
        // $('.navbar-toggler').click();
      });
    });
  </script>



  <div class="m"></div>


  <!--MODALS FOR LOGIN-->


  <!-- Modal -->
  <div class="modal fade" id="login" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Login</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form class="px-4 py-3">
            <div class="form-group">
              <label for="email">Email address</label>
              <input type="email" class="form-control" placeholder="Enter Email" name="email" required id="lemail"
                autocomplete="off" value="">
            </div>
            <div class="form-group">
              <label for="psw">Password</label>
              <input type="password" class="form-control" placeholder="Enter Password" name="psw" required
                id="lpassword">
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="dropdownCheck">
              <label class="form-check-label" for="dropdownCheck">
                Remember me
              </label>
            </div>
          </form>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" data-toggle="modal" data-target="#forget" data-dismiss="modal">Forgot
            password?</a>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" onclick="login()" id="loginbtn">Login</button>
          <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#signup"
            data-dismiss="modal">Sign up</button>

        </div>
      </div>
    </div>
  </div>
  <!-- Forgot Password modal-->
  <div class="modal fade" id="forget" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
    aria-hidden="true" style="overflow-y: scroll; max-height:85%;  margin-top: 50px; margin-bottom:50px;">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Reset Password</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form class="px-4 py-3">
            <div class="form-group">
              <label for="exampleDropdownFormEmail1">Email</label>
              <input type="email" class="form-control" placeholder="email" id="useremail">
            </div>
          </form>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="resetPass()">Send password reset
              link</button>
            <!-- <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#login" data-dismiss="modal">Login</button> -->


          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- signup -->
  <div class="modal fade" id="signup" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
    aria-hidden="true" style="overflow-y: scroll; max-height:85%;  margin-top: 50px; margin-bottom:50px;">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Sign up</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form class="px-4 py-3">
            <div class="form-group">
              <label for="exampleDropdownFormEmail1">Name</label>
              <input type="text" class="form-control" name="name" placeholder="Enter your name" id="name" required>
            </div>
            <div class="form-group">
              <label for="exampleDropdownFormEmail1">Email</label>
              <input type="email" class="form-control" name="Email" placeholder="Enter your email" id="email" required>
            </div>
            <div class="form-group">
              <label for="exampleDropdownFormPassword1">Password</label>
              <input type="password" class="form-control" name="password" placeholder="Enter new password" id="password"
                pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
                title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
                required>
            </div>
            <div class="form-group">
              <label for="exampleDropdownFormPassword1">Phone Number</label>
              <input type="tel" class="form-control" name="number" id="phonenumber" required
                placeholder="Enter phone number">
            </div>
            <div class="form-check">
              <input type="checkbox" class="form-check-input">
              <label class="form-check-label" for="dropdownCheck">
                Remember me
              </label>
            </div>
          </form>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="signup()" id="signupbutton">Sign
              up</button>
            <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#login"
              data-dismiss="modal">Login</button>


          </div>
        </div>
      </div>
    </div>
  </div>




  <!-- CARDVIEW START -->
  <div class="container" style="background-color: white;margin-top: 50px;" id="catblocks">

    <div class="row">

      <div class="col-lg-3 col-md-4 col-6 ">
        <div class="card mb-3" onclick="show(this.id)" id="Electronics">
          <img
            src="./assets/img/electronics.png"
            class="card-img-top" alt="...">
          <a href="./StoreList.html?InbjhUHHJbjO=Electronics&qwqw=uyus">
            <div class="card-body">
              <h5 class="card-title"><span>Electronics</span></h5>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
            </div>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-md-4 col-6 ">
        <div class="card mb-3" onclick="show(this.id)" id="Grocery">
          <img src="./assets/img/grocery.png" class="card-img-top" alt="...">
          <a href="./StoreList.html?InbjhUHHJbjO=Grocery&qwqw=uyus">
            <div class="card-body">
              <h5 class="card-title"><span>Grocery</span></h5>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
            </div>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-md-4 col-6 ">
        <div class="card mb-3" onclick="show(this.id)" id="Vegetables">
          <img src="./assets/img/vege.png" class="card-img-top" alt="...">
          <a href="./StoreList.html?InbjhUHHJbjO=Vegetables&qwqw=uyus">
            <div class="card-body">
              <h5 class="card-title"><span>Vegetables</span></h5>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted text-white">Last updated 3 mins ago</small></p> -->
            </div>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-md-4 col-6 ">
        <div class="card mb-3" onclick="show(this.id)" id="Non Veg">
          <img src="./assets/img/kindpng_1392807.png" class="card-img-top" alt="...">
          <a href="./StoreList.html?InbjhUHHJbjO=Vegetables&qwqw=uyus">
            <div class="card-body">
              <h5 class="card-title"><span>Non Veg</span></h5>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
            </div>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-md-4 col-6 ">
        <div class="card mb-3" onclick="show(this.id)" id="Tv Home & Furniture">
          <img src="./assets/img/tchf.png" class="card-img-top" alt="...">
          <a href="./StoreList.html?InbjhUHHJbjO=Tv Home & Furniture&qwqw=uyus">
            <div class="card-body">
              <h5 class="card-title"><span>Tv Home & Furniture</span></h5>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted text-white">Last updated 3 mins ago</small></p> -->
            </div>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-md-4 col-6 ">
        <div class="card mb-3" onclick="show(this.id)" id="Clothing">
          <img src="./assets/img/fashionwav.png" class="card-img-top" alt="...">
          <a href="./StoreList.html?InbjhUHHJbjO=Clothing&qwqw=uyus">
            <div class="card-body">
              <h5 class="card-title">Clothing</h5>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted text-white">Last updated 3 mins ago</small></p> -->
            </div>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-md-4 col-6 ">
        <div class="card mb-3" id="Books and Study Materials" onclick="show(this.id)">
          <img src="http://pngimg.com/uploads/book/book_PNG2117.png" class="card-img-top" alt="...">
          <a href="./StoreList.html?InbjhUHHJbjO=Books and Study Materials&qwqw=uyus">
            <div class="card-body">
              <h5 class="card-title">Books and Study Materials</h5>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted text-white">Last updated 3 mins ago</small></p> -->
            </div>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-md-4 col-6" onclick="checkApplyStatus()">
        <div class="card mb-3" id="Wine">
          <img src="./assets/img/wine.png" class="card-img-top" alt="...">
          <a href="#">
            <div class="card-body">
              <h5 class="card-title">Wine</h5>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted text-white">Last updated 3 mins ago</small></p> -->
            </div>
          </a>
        </div>
      </div>
      <div class="col-lg-3 col-md-4 col-6" style="height: 100%;">
        <a href="./StoreList.html?InbjhUHHJbjO=All&qwqw=uyus">
          <div class="card text-white bg-info mb-3" id="All" onclick="show(this.id)">
            <!-- <img src="..." class="card-img-top" alt="..."> -->
            <div class="card-body text-white">
              <center>
                <h5 class="">See All categories</h5>
              </center>
              <p class="card-text"></p>
              <!-- <p class="card-text"><small class="text-muted text-white">Last updated 3 mins ago</small></p> -->
            </div>
        </a>
      </div>
    </div>

  </div>


  <!-- CARDVIEW END -->


  <!--AGE VERIFICATION MODAL-->
  <div class="modal fade" id="ageform" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
    aria-hidden="true" style="overflow-y: scroll; max-height:85%;  margin-top: 50px; margin-bottom:50px;">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Age Verification</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <form class="px-4 py-3" action="javascript:submit()">
          <div class="modal-body">
            <div class="form-group">
              <label for="exampleDropdownFormEmail1">Your Age</label>
              <input type="number" class="form-control" placeholder="ex . 23" id="userage" required>
              <label for="front">Copy of both Front and back side of any of the following documents .
                <ul>
                  <li>Driving Licence</li>
                  <li>Pan Card</li>
                  <li>Aadhar Card</li>
                  <li>Voter Card</li>
                </ul>
              </label>
              <label for="front">Front Side</label>
              <input type="file" class="form-control" placeholder="Front Page" id="front" required>
              <label for="back">Back Side</label>
              <input type="file" class="form-control" placeholder="backpage" id="back" required>

              <label for="selfimage">Upload Your Photo</label>
              <input type="file" class="form-control" placeholder="selfimage" id="selfimage" required>

            </div>

            <div class="modal-footer">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">Cancel
              </button>
              <input type="submit" class="btn btn-primary">
              <!-- <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#login" data-dismiss="modal">Login</button> -->
            </div>
        </form>
      </div>
    </div>
  </div>
  </div>

  <div w3-include-html="./footer.html"></div>
  <script src="./app.js"></script>
  <div class="map2"></div>
  <div class="m"></div>
  <script>
    checkAuth();
    onReloadLocation();
    includeHTML();
    function show(cat) {
      console.log(cat);
      // document.getElementById('catblocks').style.display = "none"
      location.href = "./StoreList.html?InbjhUHHJbjO=" + cat + "&qwqw=uyus";
      if (cat === "All") {
        loadSellerList();
      } else {
        loadSellerListWithCat(cat);
      }
    }
  </script>



  <script>

    function checkApplyStatus() {
      firebase.auth().onAuthStateChanged(function (user) {
        if (user) {

          database.ref("AgeVerify/" + user.uid).once('value', snapshot => {
            console.log(snapshot.exists())
            if(snapshot.exists()){
              if(snapshot.val().state == "verified"){
                location.href = "./StoreList.html?InbjhUHHJbjO=Wine&qwqw=uyus"
              }else if(snapshot.val().state == "applied"){
                alert("Already Applied!Please wait for the Verification");
              }else if(snapshot.val().state == "rejected"){
                alert("Your application was Rejected ! Please contact admin");
              }
            }else{
              $('#ageform').modal('show');
            }
          })

        }

        else {
          alert("Please Login first");
          $('#login').modal('show');
        }
      })
    }

    function submit() {
      firebase.auth().onAuthStateChanged(function (user) {
        if (user) {
          var file1 = document.querySelector("#front").files[0];
          var file2 = document.querySelector("#back").files[0];
          var file3 = document.querySelector("#selfimage").files[0];

          var storageRef1 = firebase.app().storage().ref(user.uid + "/" + file1.name);
          var storageRef2 = firebase.app().storage().ref(user.uid + "/" + file2.name);
          var storageRef3 = firebase.app().storage().ref(user.uid + "/" + file3.name);

          var task1 = storageRef1.put(file1);
          var task2 = storageRef2.put(file2);
          var task3 = storageRef3.put(file3);

          var flag1 = false;
          var flag2 = false;
          var flag3 = false;

          var url1, url2, url3;

          task1.on('state_changed',
            function progress(snapshot) {

              var percentage = snapshot.bytesTransferred / snapshot.totalBytes * 100;
              console.log(percentage);
            },
            function error(err) {

            },
            function complete() {
              // var downloadURL = task.snapshot.downloadURL;
              // console.log(task.snapshot.ref.getDownloadURL())
              task1
                .then(snapshot => snapshot.ref.getDownloadURL())
                .then((url) => {
                  console.log(url)
                  url1 = url;
                  flag1 = true;
                  if (flag3 && flag1 && flag3) {
                    loadToDataBase(user.uid, url1, url2, url3);
                  }
                })
            }
          );
          task2.on('state_changed',
            function progress(snapshot) {

              var percentage = snapshot.bytesTransferred / snapshot.totalBytes * 100;
              console.log(percentage);
            },
            function error(err) {

            },
            function complete() {
              // var downloadURL = task.snapshot.downloadURL;
              // console.log(task.snapshot.ref.getDownloadURL())
              task2
                .then(snapshot => snapshot.ref.getDownloadURL())
                .then((url) => {
                  console.log(url)
                  url2 = url;
                  flag2 = true;
                  if (flag3 && flag1 && flag3) {
                    loadToDataBase(user.uid, url1, url2, url3);
                  }
                })
            }
          );
          task3.on('state_changed',
            function progress(snapshot) {

              var percentage = snapshot.bytesTransferred / snapshot.totalBytes * 100;
              console.log(percentage);
            },
            function error(err) {

            },
            function complete() {
              // var downloadURL = task.snapshot.downloadURL;
              // console.log(task.snapshot.ref.getDownloadURL())
              task3
                .then(snapshot => snapshot.ref.getDownloadURL())
                .then((url) => {
                  console.log(url)
                  url3 = url;
                  flag3 = true;
                  if (flag3 && flag1 && flag3) {
                    loadToDataBase(user.uid, url1, url2, url3);
                  }
                })
            }
          );

        } else {
          alert("Please Login first");
          $('#login').modal('show');
        }
      });
    }

    var database = firebase.database();

    function loadToDataBase(uid, url1, url2, url3) {

      database.ref("AgeVerify/" + uid).set({
        DocumentFront: url1,
        DocumentBack: url2,
        SelfPhoto: url3,
        age: document.getElementById('userage').value,
        state: "applied"
      }).then(() => {
        alert("Your Application was submitted Wait for the Verfication");
        $('#ageform').modal('hide');
      })
    }


  </script>

  <script src="./pace.min.js"></script>

</body>

</html>
