
  <!--MODAL FOR LOGIN -->

    <!-- Modal -->
    <div class="modal fade" id="login" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Login</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="px-4 py-3">
                        <div class="form-group">
                            <label for="email">Email address</label>
                            <input type="email" class="form-control" placeholder="Enter Email" name="email" required
                                id="lemail" autocomplete="off" value="">
                        </div>
                        <div class="form-group">
                            <label for="psw">Password</label>
                            <input type="password" class="form-control" placeholder="Enter Password" name="psw" required
                                id="lpassword">
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="dropdownCheck">
                            <label class="form-check-label" for="dropdownCheck">
                                Remember me
                            </label>
                        </div>
                    </form>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" data-toggle="modal" data-target="#forget" data-dismiss="modal">Forgot
                        password?</a>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="login()" id="loginbtn">Login</button>
                    <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#signup"
                        data-dismiss="modal">Sign up</button>

                </div>
            </div>
        </div>
    </div>
    <!-- Forgot Password modal-->
    <div class="modal fade" id="forget" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
        aria-hidden="true" style="overflow-y: scroll; max-height:85%;  margin-top: 50px; margin-bottom:50px;">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Reset Password</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="px-4 py-3">
                        <div class="form-group">
                            <label for="exampleDropdownFormEmail1">Email</label>
                            <input type="email" class="form-control" placeholder="email" id="useremail">
                        </div>
                    </form>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" onclick="resetPass()">Send password reset
                            link</button>
                        <!-- <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#login" data-dismiss="modal">Login</button> -->


                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- signup -->
    <div class="modal fade" id="signup" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
        aria-hidden="true" style="overflow-y: scroll; max-height:85%;  margin-top: 50px; margin-bottom:50px;">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Sign up</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form class="px-4 py-3">
                        <div class="form-group">
                            <label for="exampleDropdownFormEmail1">Name</label>
                            <input type="text" class="form-control" name="name" placeholder="Enter your name" id="name"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="exampleDropdownFormEmail1">Email</label>
                            <input type="email" class="form-control" name="Email" placeholder="Enter your email"
                                id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="exampleDropdownFormPassword1">Password</label>
                            <input type="password" class="form-control" name="password" placeholder="Enter new password"
                                id="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
                                title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="exampleDropdownFormPassword1">Phone Number</label>
                            <input type="tel" class="form-control" name="number" id="phonenumber" required
                                placeholder="Enter phone number">
                        </div>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input">
                            <label class="form-check-label" for="dropdownCheck">
                                Remember me
                            </label>
                        </div>
                    </form>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" onclick="signup()" id="signupbutton">Sign
                            up</button>
                        <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#login"
                            data-dismiss="modal">Login</button>


                    </div>
                </div>
            </div>
        </div>
    </div>





  
      <!-- CODE FOR LOCATION -->


      <nav id="sidebar">

        <div class="container">
          <div class="row">
            <div id="dismiss">
              <i class="fas fa-arrow-left"></i>
            </div>
    
            <div class="sidebar-header">
              <h5>Set Your Location</h5>
            </div>
          </div>
          <div class="row">
            <div class="col-md" style="margin: 10px 0px;">
              <input class="form-control mr-sm-2" title="location" name="locationin" type="text" value=""
                placeholder="e.g. Delhi" aria-label="Search" id="locationin" autocomplete="off">
              <div class="hide">
                <p id="stext">You can sreach here for area, street name, city, mantions, etc.... <br>Other wise you can give
                  your
                  current location from picking the location from the Map below.</p>
                <p>On idle position: <span id="onIdlePositionView"></span></p>
                <p>On click position: <span id="onClickPositionView"></span></p>
              </div>
            </div>
            <div class="col-md">
    
              <div id="map"></div>
              <br>
              <button id="getCurrent">Get Current Position</button>
              <button id="confirmPosition">Confirm Position</button>
            </div>
          </div>
        </div>
      </nav>
    
    
      <!--Script for Location -->
      <script src="https://unpkg.com/location-picker/dist/location-picker.min.js"></script>
  

      <script>
        // Get element references
    
        var i = 0;
        var confirmBtn = document.getElementById('confirmPosition');
        var onClickPositionView = document.getElementById('onClickPositionView');
        var onIdlePositionView = document.getElementById('onIdlePositionView');
        var map = document.getElementById('map');
    
        // Initialize LocationPicker plugin
        var lp = new locationPicker(map, {
          setCurrentPosition: true, // You can omit this, defaults to true
        }, {
          gestureHandling: 'greedy',
          streetViewControl: false,
          zoomControl: false,
          zoom: 15 // You can set any google map options here, zoom defaults to 15
        });
    
        var getCur = document.getElementById('getCurrent');
        getCur.onclick = function () {
          lp.setCurrentPosition();
        }
    
        function reload() {
          location.reload();
        }
    
        // Listen to button onclick event
        confirmBtn.onclick = function () {
          // Get current location and show it in HTML
          var location = lp.getMarkerPosition();
          onClickPositionView.innerHTML = 'The chosen location is ' + location.lat + ',' + location.lng;
          localStorage.setItem("Loclat", location.lat);
          localStorage.setItem("Loclng", location.lng);
          document.getElementById('cityname').innerHTML = localStorage.cus_city_tobe ;
          localStorage.setItem('cus_city',localStorage.cus_city_tobe);
          // document.getElementById('cityname').innerHTML = (i == 2) ? selectedcity[0] : cityName;
          $('#sidebar').toggleClass('active');
          setTimeout(() => {
            reload();
          }, 30)
        };
    
        // Listen to map idle event, listening to idle event more accurate than listening to ondrag event
        google.maps.event.addListener(lp.map, 'idle', function (event) {
          // Get current location and show it in HTML
          var location = lp.getMarkerPosition();
          var latitude = location.lat;
          var longitude = location.lng;
          var geocoder;
          geocoder = new google.maps.Geocoder();
          var latlng = new google.maps.LatLng(latitude, longitude, 1);
    
    
          geocoder.geocode(
            { 'latLng': latlng },
            function (results, status) {
              if (status == google.maps.GeocoderStatus.OK) {
                // console.log(results, status)
                if (results[0]) {
                  var add = results[0].formatted_address;
                  var value = add.split(",");
                  count = value.length;
                  country = value[count - 1];
                  state = value[count - 2];
                  city = value[count - 3];
                  console.log(value);
                  console.log("city name is: " + city);
    
                  localStorage.setItem('cus_city_tobe', $.trim(city));
    
                  onIdlePositionView.innerHTML = 'The chosen location is ' + location.lat + ',' + location.lng + " " + results[0].formatted_address;
    
                  cityName = results[0].formatted_address;
                  console.log(cityName);
                  i = i * 2;
    
                  var m = new google.maps.Map(document.getElementById('m'), {
                    center: latlng,
                    zoom: 1
                  });
    
                  // var service = new google.maps.places.PlacesService(m);
                  // service.nearbySearch({
                  //   location: latlng,
                  //   // rankBy: google.maps.places.RankBy.DISTANCE,
                  //   radius: '50',
                  //   types: ["establishment"],
                  //   types: ['address']
                  // }, function(results, status) {
                  //   if (status === google.maps.places.PlacesServiceStatus.OK) {
                  //     // for (var i = 0; i < results.length; i++) {
                  //     // //  console.log(results[i])
                  //     // }
                  //     cityName = results[0];
                  //     console.log(cityName);
                  //   } else {
                  //     alert('nearbySearch was not successful for the following reason: ' + status);
                  //   }
                  // });
                }
                else {
                  console.log("address not found");
                }
              }
              else {
                console.log("Geocoder failed due to: " + status);
              }
            }
          );
        });
    
    
        var selectedcity;
        var lat;
        var lng;
    
        var ppp;
        var autocomplete = new google.maps.places.Autocomplete(
          /** @type {!HTMLInputElement} */(
            document.getElementById('locationin')), {
          types: ['address'], types: ['establishment'],
        });
        google.maps.event.addListener(autocomplete, 'place_changed', function () {
          var place = autocomplete.getPlace();
          ppp = place;
          console.log("place name is ", place);
          selectedcity = place.name.split(',');
          i = 1;
          // document.getElementById('cityname').innerHTML = selectedcity[0];
          lp.setLocation(place.geometry.location.lat(), place.geometry.location.lng());
        });
    
    
        function onReloadLocation() {
          if (localStorage.getItem('Loclat')) {
            lp.setLocation(localStorage.getItem('Loclat'), localStorage.getItem('Loclng'))
            document.getElementById("dismiss").style.display = "block"
          } else {
            alert("Set your Location..!")
            document.getElementById("dismiss").style.display = "none"
          }
        }
    
      </script>
    
      <script
        src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script>
    
      <script type="text/javascript">
    
        $(document).ready(function () {
    
          $('#dismiss, .overlay').on('click', function () {
            $('#sidebar').removeClass('active');
          });
    
          $('#sidebarCollapse').on('click', function () {
            $('#sidebar').addClass('active');
            // locationauto();
          });
        });
      </script>
    
    

<div class="m"></div>
